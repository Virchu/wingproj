predict(q3,data.frame(x=mean(x)), interval="confidence")
x<-mtcars$wt
y<-mtcars$mpg
fit<-lm(y ~ x)
predict(fit,data.frame(x=mean(x)), interval="confidence")
?mtcars
predict(fit,data.frame(x=3), interval="prediction")
predict(fit,data.frame(x=2), interval="prediction")
predict(fit,data.frame(x=5), interval="prediction")
predict(fit,data.frame(x=.5), interval="prediction")
predict(fit,data.frame(x=x/2), interval="prediction")
fit2<-lm(y~I(x/2))
tbl2<-summary(fit2)$coefficients
summary(tbl2)
tbl2
summary(fit2)
predict(fit2,data.frame(x=mean(x)), interval="confidence")
swil()
swirl()
library(swirl)
swirl()
View(InsectSprays)
dim(InsectSprays)
head(InsectSprays)
head(InsectSprays,15)
s!
sA
summary(InsectSprays[,2])
sapply(InsectSprays)
sapply(class(InsectSprays))
sapply(InsectSprays,class)
lm(count~spray, InsectSprays)
fit<-lm(count~spray, Insectsprays)
fit<-lm(count~spray, InsectSprays)
summary(fit$coefficients)
summary(fit)$coef
est<-fit$coef[,1]
est<-Summary(fit)$coef[,1]
Summary(fit)$coef[,1]
summary(fit)$coef[,1]
est<-summary(fit)$coef[,1]
mean(sA)
mean(sB)
nfit<-lm(count~spray-1, InsectSprays)
summary(nfit)$coef
spray2<-relevel(InsectSprays$spray, "C")
fit2<-lm(count~spray, spray2)
fit2<-lm(count~spray2, InsectSprays)
summary(fit2)$coef
mean(sC)
fit$coef[2]-fit$coef[3]
(fit$coef[2]-fit$coef[3])/1.0611
(fit$coef[2]-fit$coef[3])/1.6011
library(mtcars)
mtcars
head(mtcars)
fit<-lm(mpg~cyl+wt)
fit<-lm(mpg~cyl+wt,data=mtcars)
summary(fit)
summary(fit)$coef
summary(fit)$coef[3,1]
mtcars$cyl1<-factor(mtcars$cyl)
fit<-lm(mpg~cyl+wt,data=mtcars)
summary(fit)$coef
summary(fit)$coef[3,1]
mtcars$cyl<- factor(mtcars$cyl)
fit<- lm(mpg~cyl+wt,mtcars)
summary(fit)$coef[3,1]
summary(fit)$coef
fitun<-lm(mpg~cyl, data=mtcars)
summary(fitun)$coef[3,1]
fitin<-lm(mpg~cyl*wt,data=mtcars)
summary(fitin)
summary(fit)
library(lmtest)
install.packages("lmtest")
lrtest(fit,fitin)
library(lmtest)
lrtest(fit,fitin)
lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
fit4<-lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
summary(fit4)
summary(fit4)$coef[2,1]
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit<- lm(y~x)
predict(fit)
hat(x,intercept = TRUE)
influence.measures(fit)$infmat[5,"dfb.x"]
dfbeta(x)
dfbeta(fit)
dfbeta(fit,influence)
getwd()
?Sweave
setwd("C:/Users/vmc04/Dropbox/Life history data")
lifehist<-read.csv("2017_09_28 Life history data file.csv", header=TRUE)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
head(lifehist)
setwd("C:/Users/vmc04/GitHub/wingproj/lifehist")
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
lifehist<-read.csv("2017_09_28 Life history data file.csv", header=TRUE)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
head(lifehist)
View(lifehist)
#lifehist larvae life of surviving larvae to adult
lifehist$sLL= ifelse(lifehist$Adult.death!="NA",lifehist$Pupation.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if survived to adult (time to emerge)
lifehist$Emtime= ifelse(lifehist$Adult.death!="NA",lifehist$Emergence.date-lifehist$Hatch.day ,NA)
?write.csv
#lifehist preadult length of life if died before adult Preadult.death
lifehist$Preadult.death=ifelse(!is.na(lifehist$PD),lifehist$PD-lifehist$Hatch.day,
ifelse(!is.na(lifehist$LD),lifehist$LD-lifehist$Hatch.day, NA))
#if adult death is NA, then Sex= NA
lifehist$Sex1=ifelse(is.na(lifehist$Adult.death), NA,ifelse(lifehist$Sex=="M",1,0))
#deathstatus is 0=for died preadult, 1= for died as adult
lifehist$Death_stat=ifelse(is.na(lifehist$Preadult.death), 1,0)
#Rate of adult development
lifehist$AdRate<- (1/lifehist$Emtime)
#Rate of larvae development
lifehist$LarvRate<- (1/lifehist$sLL)
#length of time as pupae
lifehist$Puplen<- lifehist$Emergence.date-lifehist$Pupation.date
#Rate of pupal development
lifehist$Puprate<- (1/lifehist$Puplen)
#rate of development if died as preadult
lifehist$D.pread.rate<- (1/lifehist$Preadult.death)
#length of adult life
lifehist$AL<- lifehist$Adult.death-lifehist$Emergence.date
#print out new datafile
write.csv(lifehist,"2017_10_17 Life history data new clean file.csv", col.names = TRUE)
write.csv(lifehist,"2017_10_17 Life history data new clean file.csv")
write.csv(lifehist,"C:/Users/vmc04/Documents/GitHub/wingproj/lifehist/2017_10_17 Life history data new clean file.csv")
lifehist<-read.csv("2017_09_28 Life history data file.csv", header=TRUE)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
head(lifehist)
#lifehist larvae life of surviving larvae to adult
lifehist$sLL= ifelse(lifehist$Adult.death!="NA",lifehist$Pupation.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if survived to adult (time to emerge)
lifehist$Emtime= ifelse(lifehist$Adult.death!="NA",lifehist$Emergence.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if died before adult Preadult.death
lifehist$Preadult.death=ifelse(!is.na(lifehist$PD),lifehist$PD-lifehist$Hatch.day,
ifelse(!is.na(lifehist$LD),lifehist$LD-lifehist$Hatch.day, NA))
#if adult death is NA, then Sex= NA
lifehist$Sex1=ifelse(is.na(lifehist$Adult.death), NA,ifelse(lifehist$Sex=="M",1,0))
#deathstatus is 0=for died preadult, 1= for died as adult
lifehist$Death_stat=ifelse(is.na(lifehist$Preadult.death), 1,0)
#Rate of adult development
lifehist$AdRate<- (1/lifehist$Emtime)
#Rate of larvae development
lifehist$LarvRate<- (1/lifehist$sLL)
#length of time as pupae
lifehist$Puplen<- lifehist$Emergence.date-lifehist$Pupation.date
#Rate of pupal development
lifehist$Puprate<- (1/lifehist$Puplen)
#rate of development if died as preadult
lifehist$D.pread.rate<- (1/lifehist$Preadult.death)
#length of adult life
lifehist$AL<- lifehist$Adult.death-lifehist$Emergence.date
#print out new datafile
write.csv(lifehist,"C:/Users/vmc04/Documents/GitHub/wingproj/lifehist/2017_10_17 Life history data new clean file.csv")
View(lifehist)
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
lifehist<-read.csv("2017_09_28 Life history data file.csv", header=TRUE)
View(lifehist)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
head(lifehist)
#lifehist larvae life of surviving larvae to adult
lifehist$sLL= ifelse(lifehist$Adult.death!="NA",lifehist$Pupation.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if survived to adult (time to emerge)
lifehist$Emtime= ifelse(lifehist$Adult.death!="NA",lifehist$Emergence.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if died before adult Preadult.death
lifehist$Preadult.death=ifelse(!is.na(lifehist$PD),lifehist$PD-lifehist$Hatch.day,
ifelse(!is.na(lifehist$LD),lifehist$LD-lifehist$Hatch.day, NA))
#if adult death is NA, then Sex= NA
lifehist$Sex1=ifelse(is.na(lifehist$Adult.death), NA,ifelse(lifehist$Sex=="M",1,0))
#deathstatus is 0=for died preadult, 1= for died as adult
lifehist$Death_stat=ifelse(is.na(lifehist$Preadult.death), 1,0)
#Rate of adult development
lifehist$AdRate<- (1/lifehist$Emtime)
#Rate of larvae development
lifehist$LarvRate<- (1/lifehist$sLL)
#length of time as pupae
lifehist$Puplen<- lifehist$Emergence.date-lifehist$Pupation.date
#Rate of pupal development
lifehist$Puprate<- (1/lifehist$Puplen)
#rate of development if died as preadult
lifehist$D.pread.rate<- (1/lifehist$Preadult.death)
#length of adult life
lifehist$AL<- lifehist$Adult.death-lifehist$Emergence.date
#print out new datafile
write.csv(lifehist,"2017_10_17 Life history data new clean file.csv")
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
lifehist<-read.csv("2017_09_28 Life history data file1.csv", header=TRUE)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
View(lifehist)
lifehist$sLL= ifelse(lifehist$Adult.death!="NA",lifehist$Pupation.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if survived to adult (time to emerge)
lifehist$Emtime= ifelse(lifehist$Adult.death!="NA",lifehist$Emergence.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if died before adult Preadult.death
lifehist$Preadult.death=ifelse(!is.na(lifehist$PD),lifehist$PD-lifehist$Hatch.day,
ifelse(!is.na(lifehist$LD),lifehist$LD-lifehist$Hatch.day, NA))
lifehist$Sex1=ifelse(is.na(lifehist$Adult.death), NA,ifelse(lifehist$Sex=="M",1,0))
#deathstatus is 0=for died preadult, 1= for died as adult
lifehist$Death_stat=ifelse(is.na(lifehist$Preadult.death), 1,0)
#Rate of adult development
lifehist$AdRate<- (1/lifehist$Emtime)
#Rate of larvae development
lifehist$LarvRate<- (1/lifehist$sLL)
#length of time as pupae
lifehist$Puplen<- lifehist$Emergence.date-lifehist$Pupation.date
#Rate of pupal development
lifehist$Puprate<- (1/lifehist$Puplen)
#rate of development if died as preadult
lifehist$D.pread.rate<- (1/lifehist$Preadult.death)
#length of adult life
lifehist$AL<- lifehist$Adult.death-lifehist$Emergence.date
write.csv(lifehist,"2017_10_17 Life history data new clean file.csv", row.names=F)
getwd()
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
getwd()
knitr::opts_chunk$set(echo = TRUE)
getwd()
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
write.csv(lifehist,"C:/Users/vmc04/Documents/GitHub/wingproj/lifehist/2017_10_17 Life history data new clean file.csv", row.names=F)
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
lifehist<-read.csv("2017_10_17 Life history data new clean file.csv", header=TRUE)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
View(lifehist)
print(head(lifehist))
print(head(lifehist))
library(ggplot2)
library(lme4)
mod1<-glm(AdRate~Temp_num*Locality*Sex,data=lifehist,family=Gamma);summary(mod1)
mod1<-glm(AdRate~Temp_num*Locality*Sex,data=lifehist,family=Gamma);summary(mod1)
mod2<-glm(AdRate~Temp_num,data=lifehist,family=Gamma);summary(mod2)
mod3<-glm(AdRate~Temp_num*Sex,data=lifehist,family=Gamma);summary(mod3)
mod4<-glm(AdRate~Temp_num*Locality,data=lifehist,family=Gamma);summary(mod4)
mod5<-glm(AdRate~Temp_num*Biome,data=lifehist,family=Gamma);summary(mod5)
mod6<-glm(AdRate~Temp_num*Biome*Sex,data=lifehist,family=Gamma);summary(mod6)
mod7<-glm(AdRate~Temp_num*State*Sex,data=lifehist,family=Gamma);summary(mod7)
mod8<-glm(AdRate~Temp_num*State,data=lifehist,family=Gamma);summary(mod8)
modelAIC<-AIC(mod1,mod2,mod3,mod4,mod5,mod6,mod7, mod8)
print(modelAIC)
print("mod1<-glm(rate~Temp*Locality*Sex,data=lifedat,family=Gamma);summary(mod1)")
print(summary(mod1))
print(modelAIC)
mod1.1<-glm(AdRate~Temp_num^2*Locality*Sex,data=lifehist,family=Gamma);summary(mod1)
mod2.1<-glm(AdRate~Temp_num^2,data=lifehist,family=Gamma);summary(mod2)
mod3.1<-glm(AdRate~Temp_num^2*Sex,data=lifehist,family=Gamma);summary(mod3)
mod4.1<-glm(AdRate~Temp_num^2*Locality,data=lifehist,family=Gamma);summary(mod4)
mod5.1<-glm(AdRate~Temp_num^2*Biome,data=lifehist,family=Gamma);summary(mod5)
mod6.1<-glm(AdRate~Temp_num^2*Biome*Sex,data=lifehist,family=Gamma);summary(mod6)
mod7.1<-glm(AdRate~Temp_num^2*State*Sex,data=lifehist,family=Gamma);summary(mod7)
mod8.1<-glm(AdRate~Temp_num^2*State,data=lifehist,family=Gamma);summary(mod8)
modelAIC1.1<-AIC(mod1.1,mod2.1,mod3.1,mod4.1,mod5.1,mod6.1,mod7.1, mod8.1)
print(modelAIC1.1)
write.table(modelAIC, "clipboard", "/t")
write.table(modelAIC, "clipboard", sep="/t")
print(modelAIC)
print(modelAIC1.1)
mod1.2<-glm(AdRate~Temp_let*Locality*Sex,data=lifehist,family=Gamma);summary(mod1)
mod2.2<-glm(AdRate~Temp_let,data=lifehist,family=Gamma);summary(mod2)
mod3.2<-glm(AdRate~Temp_let*Sex,data=lifehist,family=Gamma);summary(mod3)
mod4.2<-glm(AdRate~Temp_let*Locality,data=lifehist,family=Gamma);summary(mod4)
mod5.2<-glm(AdRate~Temp_let*Biome,data=lifehist,family=Gamma);summary(mod5)
mod6.2<-glm(AdRate~Temp_let*Biome*Sex,data=lifehist,family=Gamma);summary(mod6)
mod7.2<-glm(AdRate~Temp_let*State*Sex,data=lifehist,family=Gamma);summary(mod7)
mod8.2<-glm(AdRate~Temp_let*State,data=lifehist,family=Gamma);summary(mod8)
modelAIC<-AIC(mod1.2,mod2.2,mod3.2,mod4.2,mod5.2,mod6.2,mod7.2, mod8.2)
print(modelAIC1.2)
modelAIC<-AIC(mod1,mod2,mod3,mod4,mod5,mod6,mod7, mod8)
print(modelAIC)
modelAIC1.2<-AIC(mod1.2,mod2.2,mod3.2,mod4.2,mod5.2,mod6.2,mod7.2, mod8.2)
print(modelAIC1.2)
summary(mod4.2)
1-pchisq(34.46,2632)
lifehist_females<-subset(lifehist, Sex=="F", select=c(1:30))
lifehist_males<-subset(lifehist, Sex=="M", select=c(1:30))
mod1.3<-glm(AdRate~Temp_num*Locality*Sex,data=lifehist,family=binomial);summary(mod1.3)
mod2.3<-glm(AdRate~Temp_num,data=lifehist,family=binomial);summary(mod2.3)
mod3.3<-glm(AdRate~Temp_num*Sex,data=lifehist,family=binomial);summary(mod3.3)
mod4.3<-glm(AdRate~Temp_num*Locality,data=lifehist,family=binomial);summary(mod4.3)
mod5.3<-glm(AdRate~Temp_num*Biome,data=lifehist,family=binomial);summary(mod5.3)
mod6.3<-glm(AdRate~Temp_num*Biome*Sex,data=lifehist,family=binomial);summary(mod6.3)
mod7.3<-glm(AdRate~Temp_num*State*Sex,data=lifehist,family=binomial);summary(mod7.3)
mod8.3<-glm(AdRate~Temp_num*State,data=lifehist,family=binomial);summary(mod8.3)
modelAIC1.3<-AIC(mod1.3,mod2.3,mod3.3,mod4.3,mod5.3,mod6.3,mod7.3, mod8.3)
print(modelAIC1.3)
mod1.4<-glm(AdRate~Temp_num*Locality*Sex,data=lifehist,family=binomial(logit));summary(mod1.4)
mod2.4<-glm(AdRate~Temp_num,data=lifehist,family=binomial(logit));summary(mod2.4)
mod3.4<-glm(AdRate~Temp_num*Sex,data=lifehist,family=binomial(logit));summary(mod3.4)
mod4.4<-glm(AdRate~Temp_num*Locality,data=lifehist,family=binomial(logit));summary(mod4.4)
mod5.4<-glm(AdRate~Temp_num*Biome,data=lifehist,family=binomial(logit));summary(mod5.4)
mod6.4<-glm(AdRate~Temp_num*Biome*Sex,data=lifehist,family=binomial(logit));summary(mod6.4)
mod7.4<-glm(AdRate~Temp_num*State*Sex,data=lifehist,family=binomial(logit));summary(mod7.4)
mod8.4<-glm(AdRate~Temp_num*State,data=lifehist,family=binomial(logit));summary(mod8.4)
modelAIC1.4<-AIC(mod1.4,mod2.4,mod3.4,mod4.4,mod5.4,mod6.4,mod7.4, mod8.4)
print(modelAIC1.4)
mod1.5<-glm(AdRate~Temp_let*Locality,data=lifehist_females,family=binomial(logit));summary(mod1.5)
mod2.5<-glm(AdRate~Temp_let,data=lifehist_females,family=binomial(logit));summary(mod2.5)
mod3.5<-glm(AdRate~Temp_let*Locality,data=lifehist_females,family=binomial(logit));summary(mod3.5)
mod4.5<-glm(AdRate~Temp_let*Biome,data=lifehist_females,family=binomial(logit));summary(mod4.5)
mod5.5<-glm(AdRate~Temp_let*State,data=lifehist_females,family=binomial(logit));summary(mod5.5)
modelAIC1.5<-AIC(mod1.4,mod2.4,mod3.4,mod4.4,mod5.4,mod6.4,mod7.4, mod8.4)
print(modelAIC1.5)
modelAIC1.5<-AIC(mod1.5,mod2.5,mod3.5,mod4.5,mod5.5)
print(modelAIC1.5)
mod1.5<-glm(AdRate~Temp_let*Locality,data=lifehist_females,family=binomial(logit));summary(mod1.5)
mod2.5<-glm(AdRate~Temp_let,data=lifehist_females,family=binomial(logit));summary(mod2.5)
mod3.5<-glm(AdRate~Locality,data=lifehist_females,family=binomial(logit));summary(mod3.5)
mod4.5<-glm(AdRate~Temp_let*Biome,data=lifehist_females,family=binomial(logit));summary(mod4.5)
mod5.5<-glm(AdRate~Temp_let*State,data=lifehist_females,family=binomial(logit));summary(mod5.5)
mod6.5<-glm(AdRate~Biome,data=lifehist_females,family=binomial(logit));summary(mod6.5)
mod7.5<-glm(AdRate~State,data=lifehist_females,family=binomial(logit));summary(mod7.5)
modelAIC1.5<-AIC(mod1.5,mod2.5,mod3.5,mod4.5,mod5.5,mod6.5,mod7.5)
print(modelAIC1.5)
mod1.6<-glm(AdRate~Temp_num*Locality,data=lifehist_females,family=binomial(logit));summary(mod1.6)
mod2.6<-glm(AdRate~Temp_num,data=lifehist_females,family=binomial(logit));summary(mod2.6)
mod3.6<-glm(AdRate~Locality,data=lifehist_females,family=binomial(logit));summary(mod3.6)
mod4.6<-glm(AdRate~Temp_num*Biome,data=lifehist_females,family=binomial(logit));summary(mod4.6)
mod5.6<-glm(AdRate~Temp_num*State,data=lifehist_females,family=binomial(logit));summary(mod5.6)
mod6.6<-glm(AdRate~Biome,data=lifehist_females,family=binomial(logit));summary(mod6.6)
mod7.6<-glm(AdRate~State,data=lifehist_females,family=binomial(logit));summary(mod7.6)
modelAIC1.6<-AIC(mod1.6,mod2.6,mod3.6,mod4.6,mod5.6,mod6.6,mod7.6)
print(modelAIC1.6)
summary(mod6.5)
library(survival)
library(survminer)
lifehist$Status=ifelse(lifehist$Death_stat=2), 1,0)
lifehist$Status=ifelse(lifehist$Death_stat=2, 1,0)
lifehist$Status=ifelse(lifehist$Death_stat==2, 1,0)
View(lifehist_females)
#time (lifespan)
lifehist$time<- lifehist$Adult.death-lifehist$PD-lifehist$LD-lifehist$Hatch.day
lifehist$time<- with(lifehist, lifehist$Adult.death-lifehist$PD-lifehist$LD-lifehist$Hatch.da
lifehist$time<- with(lifehist, Adult.death-PD-LD-Hatch.day)
lifehist$time<- with(lifehist, lifehist$Adult.death-lifehist$PD-lifehist$LD-lifehist$Hatch.day, na.rm=TRUE)
?with
lifehist<-read.csv("2017_09_28 Life history data file1.csv", header=TRUE)
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
lifehist<-read.csv("2017_09_28 Life history data file1.csv", header=TRUE)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
#lifehist larvae life of surviving larvae to adult
lifehist$sLL= ifelse(lifehist$Adult.death!="NA",lifehist$Pupation.date-lifehist$Hatch.day ,NA)
#lifehist larvae life of nonsurviving larvae
lifehist$dLL= ifelse(lifehist$Adult.death=="NA",lifehist$Pupation.date-lifehist$Hatch.day ,NA)
#lifehist larvae life of nonsurviving larvae
lifehist$dLL= ifelse(lifehist$Adult.death=="NA",lifehist$LD-lifehist$Hatch.day ,NA)
#lifehist larvae life of nonsurviving larvae
lifehist$dLL= ifelse(is.na(lifehist$Adult.death),lifehist$LD-lifehist$Hatch.day ,NA)
#lifehist pupae life of nonsurviving pupae
lifehist$dPL= ifelse(is.na(lifehist$Adult.death),lifehist$PD-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if survived to adult (time to emerge)
lifehist$Emtime= ifelse(lifehist$Adult.death!="NA",lifehist$Emergence.date-lifehist$Hatch.day ,NA)
#lifehist preadult length of life if died before adult Preadult.death
lifehist$Preadult.death=ifelse(!is.na(lifehist$PD),lifehist$PD-lifehist$Hatch.day,
ifelse(!is.na(lifehist$LD),lifehist$LD-lifehist$Hatch.day, NA))
#if adult death is NA, then Sex= NA
lifehist$Sex1=ifelse(is.na(lifehist$Adult.death), NA,ifelse(lifehist$Sex=="M",1,0))
#deathstatus is 0=for died preadult, 1= for died as adult
lifehist$Death_stat=ifelse(is.na(lifehist$Preadult.death), 1,0)
#Rate of adult development
lifehist$AdRate<- (1/lifehist$Emtime)
#Rate of larvae development
lifehist$LarvRate<- (1/lifehist$sLL)
#length of time as pupae
lifehist$Puplen<- lifehist$Emergence.date-lifehist$Pupation.date
#Rate of pupal development
lifehist$Puprate<- (1/lifehist$Puplen)
#rate of development if died as preadult
lifehist$D.pread.rate<- (1/lifehist$Preadult.death)
#length of adult life
lifehist$AL<- lifehist$Adult.death-lifehist$Emergence.date
#time (lifespan)
lifehist$time<- sum(lifehist$AL,lifehist$Emtime,lifehist$dLL, lifehist$dPL, na.rm=TRUE)
lifehist$time<- rowSums(lifehist[,21:23,32],na.rm=TRUE)
#print out new datafile
write.csv(lifehist,"C:/Users/vmc04/Documents/GitHub/wingproj/lifehist/2017_10_17 Life history data new clean file.csv", row.names=F)
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
lifehist<-read.csv("2017_10_17 Life history data new clean file.csv", header=TRUE)
lifehist$Locality=factor(lifehist$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
res.cox1<-coxph(Surv(time, Death_stat)~Sex, data=lifehist)
res.cox1
summary(res.cox1)
lifehist_females<-subset(lifehist, Sex=="F", select=c(1:33))
lifehist_males<-subset(lifehist, Sex=="M", select=c(1:33))
res.cox2<-coxph(Surv(time, Death_stat)~Biome, data=lifehist_females)
summary(res.cox2)
res.cox3<-coxph(Surv(time, Death_stat)~Temp_let, data=lifehist_females)
summary(res.cox3)
res.cox3m<-coxph(Surv(time, Death_stat)~Temp_let, data=lifehist_males)
summary(res.cox3m)
res.cox4<-coxph(Surv(time, Death_stat)~State, data=lifehist_females)
summary(res.cox4)
res.cox4m<-coxph(Surv(time, Death_stat)~State, data=lifehist_males)
summary(res.cox4m)
res.cox2<-coxph(Surv(time, Death_stat)~Biome, data=lifehist_females)
summary(res.cox2)
res.cox2m<-coxph(Surv(time, Death_stat)~Biome, data=lifehist_males)
summary(res.cox2m)
res.cox5<-coxph(Surv(time, Death_stat)~Locality, data=lifehist_females)
summary(res.cox5)
res.cox5m<-coxph(Surv(time, Death_stat)~Locality, data=lifehist_males)
summary(res.cox5m)
covariates<-c("Biome", "State","Locality", "Temp_let")
univ_formulas<-sapply(covariates, function(x)as.formula(paste('Surv(time,Death_stat)~',x)))
univ_models<-lapply(univ_formulas, function(x){coxph(x,data=lifehist)})
univ_results<- lapply(univ_models, function(x) {x<-summary(x)
p.value<-signif(x$wald["pvalue"], digits=2)
wald.test<-signif(x$wald["test"], digits=2)
beta<-signif(x$coef[1], digits=2);#coeficient beta
})
univ_results<- lapply(univ_models, function(x) {x<-summary(x)
p.value<-signif(x$wald["pvalue"], digits=2)
wald.test<-signif(x$wald["test"], digits=2)
beta<-signif(x$coef[1], digits=2);#coeficient beta
HR <-signif(x$coef[2], digits=2);#exp(beta)
HR.confint.lower <- signif(x$conf.int[,"lower .95"], 2)
HR.confint.upper <- signif(x$conf.int[,"upper .95"],2)
HR <- paste0(HR, " (", HR.confint.lower, "-", HR.confint.upper, ")")
res<-c(beta, HR, wald.test, p.value)
names(res)<-c("beta", "HR (95% CI for HR)", "wald.test", "p.value")
return(res)
})
res <- t(as.data.frame(univ_results, check.names = FALSE))
univ_results <- lapply(univ_models,
function(x){
x <- summary(x)
p.value<-signif(x$wald["pvalue"], digits=2)
wald.test<-signif(x$wald["test"], digits=2)
beta<-signif(x$coef[1], digits=2);#coeficient beta
HR <-signif(x$coef[2], digits=2);#exp(beta)
HR.confint.lower <- signif(x$conf.int[,"lower .95"], 2)
HR.confint.upper <- signif(x$conf.int[,"upper .95"],2)
HR <- paste0(HR, " (",
HR.confint.lower, "-", HR.confint.upper, ")")
res<-c(beta, HR, wald.test, p.value)
names(res)<-c("beta", "HR (95% CI for HR)", "wald.test",
"p.value")
return(res)#return(exp(cbind(coef(x),confint(x))))
})
res <- t(as.data.frame(univ_results, check.names = FALSE))
as.data.frame(res)
covariates<-c("Biome", "State","Locality", "Temp_let")
univ_formulas<-sapply(covariates, function(x)as.formula(paste('Surv(time,Death_stat)~',x)))
univ_models<-lapply(univ_formulas, function(x){coxph(x,data=lifehist)})
univ_results <- lapply(univ_models,
function(x){
x <- summary(x)
p.value<-signif(x$wald["pvalue"], digits=2)
wald.test<-signif(x$wald["test"], digits=2)
beta<-signif(x$coef[1], digits=2);#coeficient beta
HR <-signif(x$coef[2], digits=2);#exp(beta)
HR.confint.lower <- signif(x$conf.int[,"lower .95"], 2)
HR.confint.upper <- signif(x$conf.int[,"upper .95"],2)
HR <- paste0(HR, " (",
HR.confint.lower, "-", HR.confint.upper, ")")
res<-c(beta, HR, wald.test, p.value)
names(res)<-c("beta", "HR (95% CI for HR)", "wald.test",
"p.value")
return(res)#return(exp(cbind(coef(x),confint(x))))
})
res <- t(as.data.frame(univ_results, check.names = FALSE))
lifeaov1<- aov(lifehist$AdRate~lifehist$Temp_let)
summary(lifeaov1)
plot(lifeaov1)
lifeaov2<- aov(lifehist$AdRate~lifehist$Temp_num)
summary(lifeaov2)
class(lifehist$Temp_let)
levels(lifehist$Temp_let)
lifehistpractice<- subset(lifehist, Temp_let=="A", select=c(1,7,27)
)
View(lifehistpractice)
lifehistpractice<- subset(lifehist, select=c(1,7,27)
)
aov(lifehistpractice$AdRate~lifehistpractice$Temp_let)
summary(aov(lifehistpractice$AdRate~lifehistpractice$Temp_let))
fit<-lm(lifehistpractice$AdRate~lifehistpractice$Temp_let)
anova(fit)
write.csv(lifehistpractice, "Lifehist practice for PAST.csv")
lifehistpractice<- subset(lifehist, !is.na(AdRate), select=c(1,7,27)
)
write.csv(lifehistpractice, "Lifehist practice for PAST.csv")
res.coxfem<-coxph(Surv(time, Death_stat)~Temp_let+Biome+State+Locality, data=lifehist_females)
summary(res.coxfem)
View(lifehist_females)
res.coxfem<-coxph(Surv(time, Death_stat)~Temp_let*Biome*State*Locality, data=lifehist_females)
summary(res.coxfem)
res.coxfem<-coxph(Surv(time, Death_stat)~Temp_let+Biome+State+Locality, data=lifehist_females)
summary(res.coxfem)
res.coxfem1<-coxph(Surv(time, Death_stat)~Temp_let+Biome, data=lifehist_females)
summary(res.coxfem1)
res.coxfem1<-coxph(Surv(time, Death_stat)~Temp_let+Biome+Locality, data=lifehist_females)
summary(res.coxfem1)
res.coxfem1<-coxph(Surv(time, Death_stat)~Temp_let+Locality, data=lifehist_females)
summary(res.coxfem1)
with(lifehist_females, table(Death_stat,Locality))
with(lifehist_females, table(Death_stat,State))
res.coxfem1<-coxph(Surv(time, Death_stat)~Temp_let+Locality, singular.ok=TRUE, data=lifehist_females)
summary(res.coxfem1)
res.coxfem<-coxph(Surv(time, Death_stat)~Temp_let+Biome+State+Locality, singular.ok=TRUE  data=lifehist_females)
res.coxfem<-coxph(Surv(time, Death_stat)~Temp_let+Biome+State+Locality, singular.ok=TRUE,  data=lifehist_females)
summary(res.coxfem)
res.coxfem<-coxph(Surv(time, Death_stat)~Temp_let+Biome+State+Locality, singular.ok=FALSE,  data=lifehist_females)
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/lifehist")
lifehistfull<-read.csv("2017_10_17 Life history data new clean file.csv", header=TRUE)
lifehistfull$Locality=factor(lifehistfull$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
#limit data to results and identifiers
colnames(lifehistfull)
View(lifehistfull)
lifehistshort<-subset(lifehistfull, select=c(1:8,16, 25, 17,20:24, 26:33 ))
View(lifehistshort)
