wing.dat.to1<-subset(wing_heritability_file, wing_heritability_file$Locality=="TLC")
wing_h2.to1<-lm(wing.dat.to1$Wing.length..mm.~ wing.dat.to1$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#2.556              0.04341
wing.dat.to2<-subset(wing_heritability_file, wing_heritability_file$Locality=="TPN")
wing_h2.to2<-lm(wing.dat.to2$Wing.length..mm.~ wing.dat.to2$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#3.1172              -0.1073
wing.dat.rj<-subset(wing_heritability_file, wing_heritability_file$Locality=="SJU")
wing_h2.rj<-lm(wing.dat.rj$Wing.length..mm.~ wing.dat.rj$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#2.828807              0.009146
wing.her.am1.test<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing_heritability_file<-adult[,c(1:4,6:13)]
fam_key<- read.csv("C:\\Users\\vmc04\\Dropbox\\Life history local\\Field family key.csv")
field_wing<- read.csv("C:\\Users\\vmc04\\Dropbox\\Life history local\\LH F wing lengths.csv")
field_details<-merge(fam_key,field_wing, by=1)
wing_heritability_file$Pwing<-field_details$Length.mm[match(wing_heritability_file$Fam_new, field_details$Fam_new)]
wing_heritability_file$Pwing_CS<-field_details$CS_18[match(wing_heritability_file$Fam_new, field_details$Fam_new)]
wing_heritability_file$Generation<- "F1"
wing_h2<-lm(wing_heritability_file$Wing.length..mm.~ wing_heritability_file$Pwing)
data_div<- levels(get("Locality",wing_heritability_file))
wing.dat.am1<-subset(wing_heritability_file, wing_heritability_file$Locality=="ARS")
wing_h2.am1<-lm(wing.dat.am1$Wing.length..mm.~ wing.dat.am1$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#2.3558              0.0957
wing.dat.am2<-subset(wing_heritability_file, wing_heritability_file$Locality=="APR")
wing_h2.am2<-lm(wing_heritability_file$Wing.length..mm.~ wing_heritability_file$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#1.8851              0.2596
wing.dat.ro1<-subset(wing_heritability_file, wing_heritability_file$Locality=="RPV")
wing_h2.ro1<-lm(wing.dat.ro1$Wing.length..mm.~ wing.dat.ro1$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#2.0435              0.2109
wing.dat.ro2<-subset(wing_heritability_file, wing_heritability_file$Locality=="RMO")
wing_h2.ro2<-lm(wing.dat.ro2$Wing.length..mm.~ wing.dat.ro2$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#2.68776              -0.006367
wing.dat.to1<-subset(wing_heritability_file, wing_heritability_file$Locality=="TLC")
wing_h2.to1<-lm(wing.dat.to1$Wing.length..mm.~ wing.dat.to1$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#2.556              0.04341
wing.dat.to2<-subset(wing_heritability_file, wing_heritability_file$Locality=="TPN")
wing_h2.to2<-lm(wing.dat.to2$Wing.length..mm.~ wing.dat.to2$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#3.1172              -0.1073
wing.dat.rj<-subset(wing_heritability_file, wing_heritability_file$Locality=="SJU")
wing_h2.rj<-lm(wing.dat.rj$Wing.length..mm.~ wing.dat.rj$Pwing)
#Coefficients:  (Intercept)  wing.dat.am1$Pwing
#2.828807              0.009146
wing.her.am1.test<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1 <-
ggplot(wing_heritability_file, aes(x=Pwing, y=Wing.length..mm., group=Fam_new))+
geom_point(aes(colour=Fam_new), subset(wing_heritability_file, Locality=="ARS"), position=position_jitter(w=.005, h=0), size=2)+
geom_point(shape=1, size=2, colour="black")+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09, H^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1 <-
ggplot(wing_heritability_file, aes(x=Pwing, y=Wing.length..mm., group=Fam_new))+
geom_point(aes(colour=Fam_new), subset(wing_heritability_file, Locality=="ARS"), position=position_jitter(w=.005, h=0), size=2)+
geom_point(shape=1, size=2, colour="black")+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09, H^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1
wing.her.am1.test<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test
wing.her.am1.test.sex<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(aes(shape=Sex), stroke=.5)+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test.sex
wing.her.am1.test.sex<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(aes(shape=Sex))+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test.sex
wing.her.am1.test.sex<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(aes(colour=Sex))+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test.sex
wing.her.am1.test.sex<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(aes(colour=Sex, shape=Fam_new))+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test.sex
wing.her.am1.test.sex<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(aes(shape=Sex, colour=Fam_new))+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test.sex
wing.her.am1.test.sex<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(aes(shape=Sex, size=5))+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test.sex
wing.her.am1.test.sex<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(aes(colour=Sex, size=3))+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test.sex
wing.her.am1.test<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot(aes(colour=Fam_new))+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test
wing.her.am1.test<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1.test
wing.her.am1<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09 \nH^2=0.19", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am1<-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=ars_cor)+
ggtitle("ARS Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.09", hjust=0)+
geom_abline(intercept = 2.3558, slope= 0.0957)
wing.her.am2 <-
ggplot(wing.dat.am2, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=ars_cor)+
ggtitle("APR Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.26", hjust=0)+
geom_abline(intercept = 1.8851, slope= 0.2596)
wing.her.ro1 <-
ggplot(wing.dat.ro1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=ars_cor)+
ggtitle("RPV Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.21", hjust=0)+
geom_abline(intercept = 2.0435, slope= 0.2109)
wing.her.ro2 <-
ggplot(wing.dat.ro2, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=ars_cor)+
ggtitle("RMO Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= -0.006", hjust=0)+
geom_abline(intercept = 2.68776, slope= -0.006367)
wing.her.ro2
wing.her.ro1
wing.her.am1
wing.her.am2
wing.her.am2 <-
ggplot(wing.dat.am2, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=apr_cor)+
ggtitle("APR Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.26", hjust=0)+
geom_abline(intercept = 1.8851, slope= 0.2596)
wing.her.ro1 <-
ggplot(wing.dat.ro1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=rpv_cor)+
ggtitle("RPV Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.21", hjust=0)+
geom_abline(intercept = 2.0435, slope= 0.2109)
wing.her.ro2 <-
ggplot(wing.dat.ro2, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=rmo_cor)+
ggtitle("RMO Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= -0.006", hjust=0)+
geom_abline(intercept = 2.68776, slope= -0.006367)
wing.her.ro1
wing.her.ro2
wing.her.ro1
wing.her.ro1 <-
ggplot(wing.dat.ro1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=rpv_cor)+
ggtitle("RPV Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.05, y = 3.1, label ="Slope= 0.21", hjust=0)+
geom_abline(intercept = 2.0435, slope= 0.2109)
wing.her.ro2 <-
ggplot(wing.dat.ro2, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=rmo_cor)+
ggtitle("RMO Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.25, y = 3.1, label ="Slope= -0.006", hjust=0)+
geom_abline(intercept = 2.68776, slope= -0.006367)
wing.her.ro1
wing.her.ro2
wing.her.ro1 <-
ggplot(wing.dat.ro1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=rpv_cor)+
ggtitle("RPV Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =2.8, y = 3.1, label ="Slope= 0.21", hjust=0)+
geom_abline(intercept = 2.0435, slope= 0.2109)
wing.her.ro2 <-
ggplot(wing.dat.ro2, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=rmo_cor)+
ggtitle("RMO Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =2.8, y = 3.15, label ="Slope= -0.006", hjust=0)+
geom_abline(intercept = 2.68776, slope= -0.006367)
wing.her.ro1
wing.her.ro1 <-
ggplot(wing.dat.ro1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=rpv_cor)+
ggtitle("RPV Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =2.6, y = 3.1, label ="Slope= 0.21", hjust=0)+
geom_abline(intercept = 2.0435, slope= 0.2109)
wing.her.ro1
wing.her.ro2
adult.loc.am1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Adult lifespan (days)") +
scale_y_continuous()+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 4.5, label ="G: p=1.6e-4 ***\nE: p=<2e-16 ***\nGEI: p=1.9e-2*\n (n=10)", hjust=0)
adult.loc.am2 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="APR"))+
ggtitle("APR Locality")+
xlab("Temperature (C)")+ ylab("Adult lifespan (days)") +
scale_y_continuous()+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=apr_cor)+
annotate("text", x =2.6, y = 5, label ="G: p=1.6e-8 ***\nE: p=<2e-16 ***\nGEI: p=6.6e-10 ***\n (n=15)", hjust=0)
adult.loc.ro1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="RPV"))+
ggtitle("RPV Locality")+
xlab("Temperature (C)")+ ylab("Adult lifespan (days)") +
scale_y_continuous()+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=rpv_cor)+
annotate("text", x =2.6, y = 4.5, label ="G: p=2.1e-6 ***\nE: p=<2e-16 ***\nGEI: p=0.21\n (n=15)", hjust=0)
adult.loc.ro2 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="RMO"))+
ggtitle("RMO Locality")+
xlab("Temperature (C)")+ ylab("Adult lifespan (days)") +
scale_y_continuous()+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=rmo_cor)+
annotate("text", x =2.6, y = 4.2, label ="G: p=1.7e-6 ***\nE: p=<2e-16 ***\nGEI: p=0.71\n (n=15)", hjust=0)
adult.loc.to1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="TLC"))+
ggtitle("TLC Locality")+
xlab("Temperature (C)")+ ylab("Adult lifespan (days)") +
scale_y_continuous()+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=tlc_cor)+
annotate("text", x =2.6, y = 3.25, label ="G: p=0.43\nE: p=<2e-16 ***\nGEI: p=0.85\n (n=8)", hjust=0)
adult.loc.to2 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="TPN"))+
ggtitle("TPN Locality")+
xlab("Temperature (C)")+ ylab("Adult lifespan (days)") +
scale_y_continuous()+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=tpn_cor)+
annotate("text", x =2.6, y = 3.5, label ="G: p=0.18\nE: p=1.1e-13 ***\nGEI: p=0.83\n (n=4)", hjust=0)
adult.loc.rj <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="SJU"))+
ggtitle("SJU Locality")+
xlab("Temperature (C)")+ ylab("Adult lifespan (days)") +
scale_y_continuous()+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=sju_cor)+
annotate("text", x =2.6, y =4.5, label ="G: p=1.3e-2 *\nE: p=<2e-16 ***\nGEI: p=0.25\n (n=11)", hjust=0)
pdf("LH local adult by fam_loc2.pdf" ,13,13)
adult_loc<-ggarrange(adult.loc.am1, adult.loc.am2,adult.loc.ro1,adult.loc.ro2, adult.loc.to1,adult.loc.to2,adult.loc.rj, labels= c("a","b", "c", "d", "e","f","g"), ncol=2, nrow=4)
annotate_figure(adult_loc,
top=text_grob("Average adult lifespan (days) in each locality by temperature and family", face="bold", size=14))
dev.off()
wing.her.to1 <-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=tlc_cor)+
ggtitle("TLC Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.04", hjust=0)+
geom_abline(intercept = 2.556, slope= 0.04341)
wing.her.to2 <-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=tpn_cor)+
ggtitle("TPN Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= -0.11", hjust=0)+
geom_abline(intercept = 3.1172, slope= -0.1073)
wing.her.rj <-
ggplot(wing.dat.am1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=sju_cor)+
ggtitle("SJU Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.009", hjust=0)+
geom_abline(intercept = 2.828807, slope= 0.009146)
wing.her.to1
wing.her.to2
tlc_cor
wing.her.to1 <-
ggplot(wing.dat.to1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=tlc_cor)+
ggtitle("TLC Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.04", hjust=0)+
geom_abline(intercept = 2.556, slope= 0.04341)
wing.her.to2 <-
ggplot(wing.dat.to2, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=tpn_cor)+
ggtitle("TPN Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= -0.11", hjust=0)+
geom_abline(intercept = 3.1172, slope= -0.1073)
wing.her.rj <-
ggplot(wing.dat.rj, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=sju_cor)+
ggtitle("SJU Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.1, y = 3.05, label ="Slope= 0.009", hjust=0)+
geom_abline(intercept = 2.828807, slope= 0.009146)
wing.her.to1
wing.her.to1 <-
ggplot(wing.dat.to1, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=tlc_cor)+
ggtitle("TLC Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.0, y = 3.08, label ="Slope= 0.04", hjust=0)+
geom_abline(intercept = 2.556, slope= 0.04341)
wing.her.to2
wing.her.rj
wing.her.rj <-
ggplot(wing.dat.rj, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=sju_cor)+
ggtitle("SJU Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.3, y = 3.27, label ="Slope= 0.009", hjust=0)+
geom_abline(intercept = 2.828807, slope= 0.009146)
wing.her.to2
wing.her.to1
wing.her.rj
wing.her.rj <-
ggplot(wing.dat.rj, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=sju_cor)+
ggtitle("SJU Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.4, y = 3.27, label ="Slope= 0.009", hjust=0)+
geom_abline(intercept = 2.828807, slope= 0.009146)
wing.her.rj
pdf("LH local loc wing heritability.pdf" ,13,13)
wing_loc<-ggarrange(wing.her.am1, wing.her.am2,wing.her.ro1,wing.her.ro2, wing.her.to1,wing.her.to2,wing.her.rj, labels= c("a","b", "c", "d", "e","f","g"), ncol=2, nrow=4)
annotate_figure(wing_loc,
top=text_grob("Wing length of laboratory reared by family (across all temperatures)", face="bold", size=14))
getwd()
warnings()
wing.her.am1
wing.her.am2
wing.her.rj <-
ggplot(wing.dat.rj, aes(x=Pwing, y=Wing.length..mm., group=Fam_new, fill=Fam_new))+
geom_point(shape=21, stroke=.5)+
geom_boxplot()+
scale_fill_manual(values=sju_cor)+
ggtitle("SJU Locality")+
xlab("Field wing length (mm)")+ ylab("Lab wing length (mm)") +
scale_y_continuous()+ theme_gray() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
annotate("text", x =3.4, y = 3.27, label ="Slope= 0.009", hjust=0)+
geom_abline(intercept = 2.828807, slope= 0.009146)
wing.her.rj
