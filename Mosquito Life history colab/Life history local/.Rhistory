library(lme4)
library(lmerTest)
library(lsmeans)
library(multcomp)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(MASS)
library(GGally)
library(ggpubr)#also for palettes
library(survival)
library(survminer)
setwd("C:\\Users\\vmc04\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Life history local")
all_data <- read.csv("C:\\Users\\vmc04\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
all_data$State<-factor(all_data$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
all_data$Locality<-factor(all_data$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
#adult only data set
adult<-subset(all_data, all_data$Death_stat==1 & !is.na(all_data$Sex1))
adult$PL<- adult$Emtime-adult$sLL
adult$time<-adult$Emtime+adult$AL
#factor
adult$State<-factor(adult$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult$Locality<-factor(adult$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
adult$Temp_fac<-factor(adult$Temp_num, levels=c(20,24,28))
##Organize data- family averages
#adult (n=2652)grouping sexes
adult.sum.nosex <- adult %>% group_by(Fam_new, Biome, State, Locality, Temp_fac, Lat_group) %>% summarize(mean.sLL = mean(sLL, na.rm = TRUE),
sd.sLL= sd(sLL, na.rm=TRUE),
N.sLL=length(sLL),
se.sLL=sd.sLL/sqrt(N.sLL),
mean.AL = mean(AL, na.rm=TRUE),
sd.AL= sd(AL, na.rm=TRUE),
N.AL=length(AL),
se.AL=sd.AL/sqrt(N.AL),
mean.wing = mean(Wing.length..mm., na.rm=TRUE),
sd.wing= sd(Wing.length..mm., na.rm=TRUE),
N.wing=length(Wing.length..mm.),
se.wing=sd.wing/sqrt(N.wing),
mean.Temp = mean(Temp_num), na.rm = TRUE,
mean.Lat = mean(Latitude, na.rm = TRUE),
sum.AL=sum(AL, na.rm=TRUE),
surv.fam=1-(N.sLL/sum.AL)) %>% data.frame
adult.sum.nosex$State<-factor(adult.sum.nosex$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult.sum.nosex$Lat_group<-factor(adult.sum.nosex$Lat_group, levels=c(1,2,3))
adult.sum.sex <- adult %>% group_by(Fam_new, Biome, State, Locality, Temp_fac, Lat_group, Sex) %>% summarize(mean.sLL = mean(sLL, na.rm = TRUE),
sd.sLL= sd(sLL, na.rm=TRUE),
N.sLL=length(sLL),
se.sLL=sd.sLL/sqrt(N.sLL),
mean.AL = mean(AL, na.rm=TRUE),
sd.AL= sd(AL, na.rm=TRUE),
N.AL=length(AL),
se.AL=sd.AL/sqrt(N.AL),
mean.wing = mean(Wing.length..mm., na.rm=TRUE),
sd.wing= sd(Wing.length..mm., na.rm=TRUE),
N.wing=length(Wing.length..mm.),
se.wing=sd.wing/sqrt(N.wing),
mean.Temp = mean(Temp_num), na.rm = TRUE,
mean.Lat = mean(Latitude, na.rm = TRUE),
sum.AL=sum(AL, na.rm=TRUE),
surv.fam=1-(N.sLL/sum.AL)) %>% data.frame
adult.sum.sex$State<-factor(adult.sum.sex$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult.sum.sex$Lat_group<-factor(adult.sum.sex$Lat_group, levels=c(1,2,3))
ars_cor<- get_palette(palette="Reds",10)
#APR purple
apr_cor<-get_palette(palette="Purples", 15)
#RPV blue
rpv_cor<-get_palette(palette="Blues", 15)
#RMO cyan
rmo_cor<-get_palette(palette=c("cadetblue", "skyblue", "aquamarine", "cyan"),15)
#TLC green
tlc_cor<-get_palette(palette="Greens", 8)
#TPN yellow
tpn_cor<-get_palette(palette=c("darkorange", "darkgoldenrod", "goldenrod", "yellow3"), 4)
#SJU grayscale
sju_cor<-get_palette(palette="Greys", 11)
larv.loc.am1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean")+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1
larv.loc.am1
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4)+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean")+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1
larv.loc.am1.1
View(adult.sum.nosex)
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, State=="Amazonas"),stat="summary", colour="black",linetype=1,size=.8,width=.4)+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean")+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean")+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.test<- larv.loc.am1.1 +
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality== "ARS"), stat="summary", colour="black",linetype=1,size=.8,width=.4)
larv.loc.am1.1
larv.loc.test<- larv.loc.am1.1 +
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality== "ARS"), stat="summary", colour="black",linetype=1,size=.8,width=.4)
larv.loc.test
larv.loc.test<- larv.loc.am1.1 +
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality== "ARS"))
larv.loc.test
larv.loc.test<- larv.loc.am1.1 +
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality== "ARS",, colour="black",linetype=1,size=.8,width=.4))
larv.loc.test
larv.loc.test<- larv.loc.am1.1 +
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality== "ARS"), colour="black",linetype=1,size=.8,width=.4)
larv.loc.test
install.packages("sommer")
library(sommer)
vignette('sommer.start')
head(adult)
wing_her<-mmer(Wing.length..mm.~1, random=~ Fam_new+Temp_let+Fam_new:Temp_let, data=adult)
summary(wing_her)
summary(wing_her)
summary(wing_her)$varcomp
n.env<-length(levels(adult$Temp_let))
n.env
pin(wing_her, h2 ~ V1/ (V1 = (V3/n.env) + (V5/(2*n.env))))
pin(wing_her, h2 ~ V1/ (V1 + (V3/n.env) + (V5/(2*n.env))))
pin(wing_her, h2 ~ V1/ (V1 + (V3/n.env))
pin(wing_her, h2 ~ V1/ (V1 + (V3/n.env)))
larv_her<-mmer(sLL~1, random=~ Fam_new+Temp_let+Fam_new:Temp_let, data=adult)
summary(larv_her)$varcomp
n.env<-length(levels(adult$Temp_let))
pin(larv_her, h2 ~ V1/ (V1 + (V3/n.env)))
larv_her_state<-mmer(sLL~1, random=~ State+Temp_let+State:Temp_let, data=adult)
summary(larv_her_state)$varcomp
n.env<-length(levels(adult$Temp_let))
pin(larv_her_state, h2 ~ V1/ (V1 + (V3/n.env)))
wing_her<-mmer(Wing.length..mm.~1, random=~ Fam_new+Temp_let+Fam_new:Temp_let, rcov= ~units, data=adult)
summary(wing_her)$varcomp
n.env<-length(levels(adult$Temp_let))
pin(wing_her, h2 ~ V1/ (V1 + (V3/n.env)))
load("mod7_data.R")
?Galton
??Galton
data(Galton)
install.packages("HistData")
Libary(HistData)
library(HistData)
summary(Galton)
var(Galton[,1])
var(Galton[,2])
load("C:\\Users\\vmc04\\Desktop\\mod7_data.R")
summary(Galton)
plot(Galton[,1],Galton[,2])
plot(Galton[,1]+rnorm(928,0,.1),Galton[,2]+rnorm(928,0,.1),
xlab="Father’s Height",ylab="Child’s Height")
abline(v=mean(Galton[,1]),col=2,lty=3,lwd=3)
abline(h=mean(Galton[,2]),col=2,lty=3,lwd=3)
abline(a=0,b=1,col=2,lty=3,lwd=3)
View(Galton)
lm(Galton[,2]~Galton[,1])
summary(kinmice)
View(kinmice)
head(adult)
wing_heritability_file<-adult[,c(1-4,6-13)]
View(wing_heritability_file)
wing_heritability_file<-adult[,c(1:4,6:13)]
fam_key<- read.xlsx("C:\\Users\\vmc04\\Dropbox\\Life history local\\Field family key.xlsx")
field_wing<- read.xlsx("C:\\Users\\vmc04\\Dropbox\\Life history local\\LH F wing lengths.xlsx")
fam_key<- read.csv("C:\\Users\\vmc04\\Dropbox\\Life history local\\Field family key.csv")
field_wing<- read.csv("C:\\Users\\vmc04\\Dropbox\\Life history local\\LH F wing lengths.csv")
