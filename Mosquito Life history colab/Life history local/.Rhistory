mean.surv= mean(Death_stat, na.rm=TRUE),
mean.Temp= mean(Temp_num, na.rm=TRUE),
mean.Lat=mean(Latitude, na.rm=TRUE)) %>% data.frame
#all_data (n=3430) grouping sexes
all.sum.nosex <- all_data %>% group_by(Fam_new, Biome, State, Locality, Lat_group) %>% summarize(mean.sLL = mean(sLL, na.rm = TRUE),
mean.surv= mean(Death_stat, na.rm=TRUE),
mean.Temp = mean(Temp_num, na.rm=TRUE),
mean.Lat=mean(Latitude, na.rm=TRUE)) %>% data.frame
#adult (n=2652) with separate sexes
adult.sum <- adult %>% group_by(Fam_new, Biome, State, Locality, Sex, Temp_fac, Lat_group) %>% summarize(mean.sLL = mean(sLL, na.rm = TRUE),
sd.sLL= sd(sLL, na.rm=TRUE),
N.sLL=length(sLL),
se.sLL=sd.sLL/sqrt(N.sLL),
mean.AL = mean(AL, na.rm=TRUE),
sd.AL= sd(AL, na.rm=TRUE),
N.AL=length(AL),
se.AL=sd.AL/sqrt(N.AL),
mean.wing = mean(Wing.length..mm., na.rm=TRUE),
sd.wing= sd(Wing.length..mm., na.rm=TRUE),
N.wing=length(Wing.length..mm.),
se.wing=sd.wing/sqrt(N.wing),
mean.Temp = mean(Temp_num), na.rm = TRUE,
mean.Lat = mean(Latitude, na.rm = TRUE)) %>% data.frame
#adult (n=2652)grouping sexes
adult.sum.nosex <- adult %>% group_by(Fam_new, Biome, State, Locality, Temp_fac, Lat_group) %>% summarize(mean.sLL = mean(sLL, na.rm = TRUE),
sd.sLL= sd(sLL, na.rm=TRUE),
N.sLL=length(sLL),
se.sLL=sd.sLL/sqrt(N.sLL),
mean.AL = mean(AL, na.rm=TRUE),
sd.AL= sd(AL, na.rm=TRUE),
N.AL=length(AL),
se.AL=sd.AL/sqrt(N.AL),
mean.wing = mean(Wing.length..mm., na.rm=TRUE),
sd.wing= sd(Wing.length..mm., na.rm=TRUE),
N.wing=length(Wing.length..mm.),
se.wing=sd.wing/sqrt(N.wing),
mean.Temp = mean(Temp_num), na.rm = TRUE,
mean.Lat = mean(Latitude, na.rm = TRUE)) %>% data.frame
adult.sum.nosex$State<-factor(adult.sum.nosex$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult.sum.nosex$Lat_group<-factor(adult.sum.nosex$Lat_group, levels=c(1,2,3))
field.sum <- field_wing %>% group_by(Biome, State, Latitude, Lat_grouple) %>%
summarize (mean.wing=mean(Length.mm, na.rm=TRUE),
sd.wing= sd(Length.mm, na.rm=TRUE),
N.wing=length(Length.mm),
se.wing=sd.wing/sqrt(N.wing)) %>% data.frame
field.sum$State<-factor(field.sum$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
#group for correlations
adult.sum.corsub <- adult.sum[c(1:8,12,16)]
adult.sum.corsub$Temp<-as.numeric(adult.sum.corsub$Temp_fac)
adult.sum.corsub$Sex0<-ifelse(adult.sum.corsub$Sex=="M", 1,0)
adult.sum.corsub$Bio<-ifelse(adult.sum.corsub$Biome=="Amazon", 0,
ifelse(adult.sum.corsub$Biome=="Cerrado",1,2))
adult.sum.corsub$State0<-ifelse(adult.sum.corsub$State=="Amazonas", 0,
ifelse(adult.sum.corsub$State=="Rondonia",1,
ifelse(adult.sum.corsub$State=="Tocantins",2,3)))
##Plots of data
#Larvae development#
#sup a.1- larvae development fam averages by state over temperature
larv.am <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Amazonas"))+
ggtitle("Amazonas State")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
larv.ro <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Rondonia"))+
ggtitle("Rondonia State")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
larv.to <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Tocantins"))+
ggtitle("Tocantins State")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
larv.rj <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Rio de Janeiro"))+
ggtitle("Rio de Janeiro State")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
#arrange plots
grid.arrange(larv.am, larv.ro, larv.to, larv.rj, ncol=2, nrow=2, top="Average larvae development time (days) by Temperature and Family")
#fig a.1- larvae development state averages over temperature
larv.state.line<-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=interaction(Biome,Lat_group),colour=State, shape=Biome, linetype = Lat_group))+
geom_line(aes(linetype = Lat_group),size=1,position=position_dodge(0.5), stat="summary", fun.y="mean")+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),stat="summary", colour="black",linetype=1,size=.8,width=.6, position=position_dodge(0.5))+
geom_point(colour="black", size=4,position=position_dodge(0.5), stat="summary", fun.y="mean")+
geom_point(aes(shape = Biome), size=2.1, position=position_dodge(0.5), stat="summary", fun.y="mean")+
ggtitle("Average larvae development by temperature and state")+
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +
theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=10))+
labs(x="Temperature (C)", y="Larvae development (days)", linetype="Latitude group" )
#Adult longevity#
#sup b.1
adult.am <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Amazonas"))+
ggtitle("Amazonas State")+
xlab("Temperature (C)")+ ylab("Adult time (days)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
adult.ro <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Rondonia"))+
ggtitle("Rondonia State")+
xlab("Temperature (C)")+ ylab("Adult time (days)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
adult.to <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Tocantins"))+
ggtitle("Tocantins State")+
xlab("Temperature (C)")+ ylab("Adult time (days)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
adult.rj <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Rio de Janeiro"))+
ggtitle("Rio de Janeiro State")+
xlab("Temperature (C)")+ ylab("Adult time (days)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
#arrange plots
grid.arrange(adult.am, adult.ro, adult.to, adult.rj, ncol=2, nrow=2, top="Average Adult development time (days) by Temperature and Family")
#adult life
#fig b.1
adult.state.line<-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=interaction(Biome,Lat_group),colour=State, shape=Biome, linetype = Lat_group))+
geom_line(aes(linetype = Lat_group),size=1,position=position_dodge(0.5), stat="summary", fun.y="mean")+
geom_errorbar(aes(ymin=mean.AL-se.AL, ymax=mean.AL+se.AL),stat="summary", colour="black",linetype=1,size=.8,width=.6, position=position_dodge(0.5))+
geom_point(colour="black", size=4,position=position_dodge(0.5), stat="summary", fun.y="mean")+
geom_point(aes(shape = Biome), size=2.1, position=position_dodge(0.5), stat="summary", fun.y="mean")+
ggtitle("Average adult life by temperature and state")+
scale_y_continuous(breaks = c(1: 6))+ theme_classic() +
theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=10))+
scale_x_discrete(limit = c(20, 24,28))+
labs(x="Temperature (C)", y="Adult time (days)", linetype="Latitude group" )
#Wing length#
#sup c.1
wing.am <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Amazonas"))+
ggtitle("Amazonas State")+
xlab("Temperature (C)")+ ylab("Wing length (mm)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
wing.ro <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Rondonia"))+
ggtitle("Rondonia State")+
xlab("Temperature (C)")+ ylab("Wing length (mm)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
wing.to <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Tocantins"))+
ggtitle("Tocantins State")+
xlab("Temperature (C)")+ ylab("Wing length (mm)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
wing.rj <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.AL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, State=="Rio de Janeiro"))+
ggtitle("Rio de Janeiro State")+
xlab("Temperature (C)")+ ylab("Wing length (mm)") +
scale_y_continuous(breaks = c(0:6))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
#arrange plots
grid.arrange(wing.am, wing.ro, wing.to, wing.rj, ncol=2, nrow=2, top="Average Wing length (mm) by Temperature and Family")
##GLMM models
#redid with state instead of pop for SPH poster
PQL_meth_sLL<- glmmPQL(sLL~Temp_fac*State, ~1|Locality/Family, family=gaussian(link="log"), data=adult, verbose=FALSE)
summary(PQL_meth_sLL)
#comparing interactions
lar_ls<- lsmeans(PQL_meth_sLL, pairwise ~Temp_fac:State, adjust="tukey")
lar_cld<- cld(lar_ls, alpha=0.5, Letters=letters, adjust="tukey")
PQL_meth_em<- glmmPQL(Emtime~Temp_fac*Pop, ~1|Locality/Family, family=gaussian(link="log"), data=adult, verbose=FALSE)
summary(PQL_meth_em)
#comparing interactions
em_ls<- lsmeans(PQL_meth_em, pairwise ~Temp_fac:Pop, adjust="tukey")
em_cld<- cld(em_ls, alpha=0.5, Letters=letters, adjust="tukey")
PQL_meth_al<- glmmPQL(AL~Temp_fac*State, ~1|Locality/Family, family=poisson, data=adar_adult, verbose=FALSE)
summary(PQL_meth_al)
#comparing interactions
al_ls<- lsmeans(PQL_meth_al, pairwise ~Temp_fac:State, adjust="tukey")
al_cld<- cld(al_ls, alpha=0.5, Letters=letters, adjust="tukey")
PQL_meth_wing<- glmmPQL(Wing.length..mm.~Temp_fac*State, ~1|Locality/Family, family=gaussian(link="log"), data=adar_adult, verbose=FALSE)
summary(PQL_meth_wing)
#comparing interactions
wing_ls<- lsmeans(PQL_meth_wing, pairwise ~Temp_fac:State, adjust="tukey")
wing_cld<- cld(wing_ls, alpha=0.5, Letters=letters, adjust="tukey")
##ANOVA tables for gen var, phen plast and G by E
#Larvae
larv_mod<-lmer(sLL~Temp_let*State+(1|Fam_new)+(1|State:Temp_let:Fam_new), data=adar_adult)
anova(larv_mod) #both Treatment and State sig as well as interaction
difflsmeans(larv_mod, test.effs="State") #all state comparisons except rio and tocantins significant
difflsmeans(larv_mod, test.effs="Temp_let") #all temp comparisons significant
l.vc<-VarCorr(larv_mod)
print(l.vc, comp=c("Variance"))
#adult
adult_mod<-lmer(AL~Temp_let*State+(1|Fam_new)+(1|State:Temp_let:Fam_new), data=adar_adult)
anova(adult_mod) #both Treatment and State sig as well as interaction
rand(adult_mod)#get random effects table
difflsmeans(adult_mod, test.effs="State") #all state comparisons except rio and tocantins significant
difflsmeans(adult_mod, test.effs="Temp_let") #all temp comparisons significant
#wing length
wing_mod<-lmer(Wing.length..mm.~Temp_let*State+(1|Fam_new)+(1|State:Temp_let:Fam_new), data=adar_adult)
anova(wing_mod) #both Treatment and State sig as well as interaction
rand(wing_mod)#get random effects table
difflsmeans(wing_mod, test.effs="State") #Wing.length..mm.all state comparisons except amazonas and rondonia significant
difflsmeans(wing_mod, test.effs="Temp_let") #Wing.length..mm.all temp comparisons significant
###ANOVAS with sex for supplemental
#male=1
larv_mod1<-lmer(sLL~Temp_let*State*Sex1+(1|Fam_new)+(1|State:Temp_let:Fam_new), data=adar_adult)
anova(larv_mod1) #both Treatment and State sig as well as interaction
adult_mod1<-lmer(AL~Temp_let*State*Sex1+(1|Fam_new)+(1|State:Temp_let:Fam_new), data=adar_adult)
anova(adult_mod1)
wing_mod1<-lmer(Wing.length..mm.~Temp_let*State*Sex1+(1|Fam_new)+(1|State:Temp_let:Fam_new), data=adar_adult)
anova(wing_mod1)
### Correlations:
adult.sum.corsub1<-adult.sum.corsub[c(1,13,7,14,4,11,12,8:10)]
names(adult.sum.corsub1)<-c("Family", "Biome", "Latitude", "State", "Locality","Temp", "Sex", "Avg.Larvae", "Avg.Adult", "Avg.Wing")
ggcorr(adult.sum.corsub1,
label=TRUE,
label_alpha=0.75,
hjust=0.4)
#smaller graph
cor1<-ggcorr(adult.sum.corsub1[,c(4,6:10)],
label=TRUE,
label_alpha=0.75,
hjust=0.65,
layout.exp = 1)
#larvae and wing correlation plot
larwing<-lm(adult.sum.corsub1$Avg.Wing~adult.sum.corsub1$Avg.Larvae)
larvwing.cor <-
ggplot(adult.sum.corsub, aes(x=mean.sLL, y=mean.wing,group=Temp_fac))+
geom_point(aes(colour=Temp_fac))+
geom_smooth(method='lm')+
geom_abline(colour="black", size=1.5, alpha=0.5, intercept = 1.985, slope = 0.03894)+
#ggtitle("Larvae development and Wing length")+
xlab("Average larvae development (days)")+ ylab("Average wing length (mm)") +
theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))
install.packages("lsmeans")
library(lsmeans)
lar_ls<- lsmeans(PQL_meth_sLL, pairwise ~Temp_fac:State, adjust="tukey")
library(lme4)
library(lmerTest)
library(lsmeans)
library(multcomp)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(MASS)
library(GGally)
library(ggpubr)
library(survival)
library(survminer)
library(stargazer)
install.packages("survminer")
install.packages("stargazer")
library(survminer)
library(stargazer)
library(lme4)
all_data <- read.csv("C:\\Users\\virgc\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
adult<-subset(all_data, all_data$Death_stat==1 & !is.na(all_data$Sex1))
#factor
all_data$State<-factor(all_data$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
all_data$Locality<-factor(all_data$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
adult$State<-factor(adult$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult$Locality<-factor(adult$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
adult$Temp_fac<-factor(adult$Temp_num, levels=c(20,24,28))
all_data <- read.csv("C:\\Users\\virgc\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
adult<-subset(all_data, all_data$Death_stat==1 & !is.na(all_data$Sex1))
#factor
all_data$State<-factor(all_data$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
all_data$Locality<-factor(all_data$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
adult$State<-factor(adult$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult$Locality<-factor(adult$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
adult$Temp_fac<-factor(adult$Temp_num, levels=c(20,24,28))
head(adult)
ARS<-subset(adult, adult$Locality=="ARS" )
View(ARS)
APR<-subset(adult, adult$Locality=="APR" )
RMO<-subset(adult, adult$Locality=="RMO" )
RPV<-subset(adult, adult$Locality=="RPV" )
TLC<-subset(adult, adult$Locality=="TLC" )
TPN<-subset(adult, adult$Locality=="TPN" )
SJU<-subset(adult, adult$Locality=="SJU" )
?anova
?aov
lar_ars<-aov(sLL~Family*Temp_num, ARS)
summary(lar_ars)
View(ARS)
View(ARS)
lar_apr<-aov(sLL~Family*Temp_num, APR)
summary(lar_apr)
lar-apr
lar_apr
lar_ars<-aov(sLL~Family*Temp_let, ARS)
summary(lar_ars)
lar_ars<-aov(sLL~Fam_new*Temp_let, ARS)
summary(lar_ars)
lar_apr<-aov(sLL~Fam_new*Temp_let, APR)
summary(lar_apr)
lar_sju<-aov(sLL~Fam_new*Temp_let, SJU)
summary(lar_sju)
##Install libraries
library(lme4)
library(lmerTest)
library(lsmeans)
library(multcomp)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(MASS)
library(GGally)
library(ggpubr)
library(survival)
library(survminer)
all_data <- read.csv("C:\\Users\\virgc\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
getwd()
all_data <- read.csv("C:\\Users\\virgc\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
field_wing<-read.csv("C:\\Users\\vmc04\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_04_20 Field wing length 13 18 cs scaled.csv")
field_wing<-read.csv("C:\\Users\\virgc\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_04_20 Field wing length 13 18 cs scaled.csv")
setwd("C:\\Users\\virgc\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files")
all_data <- read.csv("C:\\Users\\virgc\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
all_data <- read.csv("C:\\Users\\virgc\\Documents\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
getwd()
library(lme4)
library(lmerTest)
library(lsmeans)
library(multcomp)
library(dplyr)
library(ggplot2)
library(gridExtra)
library(MASS)
library(GGally)
library(ggpubr)#also for palettes
library(survival)
library(survminer)
setwd("C:\\Users\\virgc\\GitHub\\wingproj\\Mosquito Life history colab\\Life history local")
all_data <- read.csv("C:\\Users\\virgc\\GitHub\\wingproj\\Mosquito Life history colab\\Data files\\2018_03_28 Brazil adar16 Life history full.csv")
all_data$State<-factor(all_data$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
all_data$Locality<-factor(all_data$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
#adult only data set
adult<-subset(all_data, all_data$Death_stat==1 & !is.na(all_data$Sex1))
adult$PL<- adult$Emtime-adult$sLL
adult$time<-adult$Emtime+adult$AL
#factor
adult$State<-factor(adult$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult$Locality<-factor(adult$Locality, levels=c("ARS", "APR", "RPV", "RMO","TLC","TPN", "SJU"))
adult$Temp_fac<-factor(adult$Temp_num, levels=c(20,24,28))
##Organize data- family averages
#adult (n=2652)grouping sexes
adult.sum.nosex <- adult %>% group_by(Fam_new, Biome, State, Locality, Temp_fac, Lat_group) %>% summarize(mean.sLL = mean(sLL, na.rm = TRUE),
sd.sLL= sd(sLL, na.rm=TRUE),
N.sLL=length(sLL),
se.sLL=sd.sLL/sqrt(N.sLL),
mean.AL = mean(AL, na.rm=TRUE),
sd.AL= sd(AL, na.rm=TRUE),
N.AL=length(AL),
se.AL=sd.AL/sqrt(N.AL),
mean.wing = mean(Wing.length..mm., na.rm=TRUE),
sd.wing= sd(Wing.length..mm., na.rm=TRUE),
N.wing=length(Wing.length..mm.),
se.wing=sd.wing/sqrt(N.wing),
mean.Temp = mean(Temp_num), na.rm = TRUE,
mean.Lat = mean(Latitude, na.rm = TRUE),
sum.AL=sum(AL, na.rm=TRUE),
surv.fam=1-(N.sLL/sum.AL)) %>% data.frame
adult.sum.nosex$State<-factor(adult.sum.nosex$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult.sum.nosex$Lat_group<-factor(adult.sum.nosex$Lat_group, levels=c(1,2,3))
adult.sum.sex <- adult %>% group_by(Fam_new, Biome, State, Locality, Temp_fac, Lat_group, Sex) %>% summarize(mean.sLL = mean(sLL, na.rm = TRUE),
sd.sLL= sd(sLL, na.rm=TRUE),
N.sLL=length(sLL),
se.sLL=sd.sLL/sqrt(N.sLL),
mean.AL = mean(AL, na.rm=TRUE),
sd.AL= sd(AL, na.rm=TRUE),
N.AL=length(AL),
se.AL=sd.AL/sqrt(N.AL),
mean.wing = mean(Wing.length..mm., na.rm=TRUE),
sd.wing= sd(Wing.length..mm., na.rm=TRUE),
N.wing=length(Wing.length..mm.),
se.wing=sd.wing/sqrt(N.wing),
mean.Temp = mean(Temp_num), na.rm = TRUE,
mean.Lat = mean(Latitude, na.rm = TRUE),
sum.AL=sum(AL, na.rm=TRUE),
surv.fam=1-(N.sLL/sum.AL)) %>% data.frame
adult.sum.sex$State<-factor(adult.sum.sex$State, levels=c("Amazonas", "Rondonia", "Tocantins", "Rio de Janeiro"))
adult.sum.sex$Lat_group<-factor(adult.sum.sex$Lat_group, levels=c(1,2,3))
##create data subsets
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS", position=dodge))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4, position=dodge)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean",position=dodge)+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
dodge<-position_dodge(width=0.5)
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS", position=dodge))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4, position=dodge)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean",position=dodge)+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1
head(adult.sum.nosex)
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS", position=dodge))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4, position=dodge)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean",position=dodge)+
ggtitle("ARS Locality")
larv.loc.am1.1
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS", position=dodge))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4, position=dodge)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean",position=dodge)+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS", position=dodge))
larv.loc.am1.1
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS", position=dodge))+
#geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4, position=dodge)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean",position=dodge)+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1
ars_cor<- get_palette(palette="Reds",10)
#APR purple
apr_cor<-get_palette(palette="Purples", 15)
#RPV blue
rpv_cor<-get_palette(palette="Blues", 15)
#RMO cyan
rmo_cor<-get_palette(palette=c("cadetblue", "skyblue", "aquamarine", "cyan"),15)
#TLC green
tlc_cor<-get_palette(palette="Greens", 8)
#TPN yellow
tpn_cor<-get_palette(palette=c("darkorange", "darkgoldenrod", "goldenrod", "yellow3"), 4)
#SJU grayscale
sju_cor<-get_palette(palette="Greys", 11)
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS", position=dodge))+
#geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4, position=dodge)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean",position=dodge)+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
ars_cor<- get_palette(palette="Reds",10)
#APR purple
apr_cor<-get_palette(palette="Purples", 15)
#RPV blue
rpv_cor<-get_palette(palette="Blues", 15)
#RMO cyan
rmo_cor<-get_palette(palette=c("cadetblue", "skyblue", "aquamarine", "cyan"),15)
#TLC green
tlc_cor<-get_palette(palette="Greens", 8)
#TPN yellow
tpn_cor<-get_palette(palette=c("darkorange", "darkgoldenrod", "goldenrod", "yellow3"), 4)
#SJU grayscale
sju_cor<-get_palette(palette="Greys", 11)
larv.loc.am1.1
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
#geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4, position=dodge)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean")+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
geom_errorbar(aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),subset(adult.sum.nosex, Locality=="ARS"),stat="summary", colour="black",linetype=1,size=.8,width=.4)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean")+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
larv.loc.am1.1
?geom_errorbar
larv.loc.am1.1 <-
ggplot(adult.sum.nosex, aes(x=Temp_fac, y=mean.sLL, group=Fam_new))+
geom_line(aes(colour=Fam_new), subset(adult.sum.nosex, Locality=="ARS"))+
geom_errorbar(subset(adult.sum.nosex, Locality=="ARS"),aes(ymin=mean.sLL-se.sLL, ymax=mean.sLL+se.sLL),stat="summary", colour="black",linetype=1,size=.8,width=.4)+
geom_point(aes(colour=Fam_new), size=4,subset(adult.sum.nosex, Locality=="ARS"), stat="summary", fun.y="mean")+
ggtitle("ARS Locality")+
xlab("Temperature (C)")+ ylab("Larvae time (days)") +
scale_y_continuous(breaks = c(13: 24))+ theme_classic() +theme(plot.title = element_text(hjust = 0.5), legend.text = element_text(size=7))+
scale_color_manual(values=ars_cor)+
annotate("text", x =2.6, y = 18.5, label ="G: p=1.5e-9 ***\nE: p=2e-16 ***\nGEI: p=0.11\n (n=10)", hjust=0)
