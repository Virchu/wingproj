library(UsingR)
example(anscombe)
library(swirl)
install.packages("swirl")
library(swirl)
swirl
swirl()
install.packages("swirl")
library(swirl)
rm(list=ls())
library(swirl)
swirl()
fit<-lm(child~parent, data=galton)
sqrt(fit$residuals/n-2)
sqrt(sum(fit$residuals^2)/n-2)
sqrt(sum(fit$residuals^2)/n-2))
sqrt(sum(fit$residuals^2) / (n - 2))
summary(fit)$sigma
sqrt(deviance(fit)/(n-2))
mu<- mean(galton$child)
sTot<-galton$child-mu
sTot<-sum((galton$child-mu)^2)
sRes<-sum()
sRes<-deviance(fit)
1-sRes/sTot
summary(fit)$r.squared
cor(galton$child, galton$parents)
cor(galton$child)
cor(galton)
cor(galton$parent,galton$child)^2
ones <- rep(1, nrow(galton))
ones
swirl)_
swirl()
lm(child ~ ones + parent -1, galton)
lm(child ~ ones + parent, galton)
lm(child~1, galton)
head(trees)
fit <- lm(Volume ~ Girth + Height + Constant -1, trees)
trees<-eliminat("Girth",trees)
trees2 <-
| eliminate("Girth", trees
trees2 <-eliminate("Girth", trees
)
head(trees2)
fit2 <- lm(Volume ~ Height + Constant -1, trees2)
lapply(list(fit, fit2), coef)
lm(., data=swiss)
all<-lm(., data=swiss)
all<-lm(Fertility~., data=swiss)
summary(all)
summary(lm(Fertility~Agriculture, data=swiss))
cov(swiss$Examination,swiss$Education)
cor(swiss$Examination,swiss$Education)
cor(swiss$Agriculture,swiss$Education)
makelms(data=swiss)
makelms()
ec<-sum(swiss$Examination+swiss$Catholic)
ec<-swiss$Examination+swiss$Catholic
efit<-lm(Fertility~.+ec, data=swiss)
coef(all)-coef(efit)
all$coefficients-efit$coefficients
x <- c(0.61, 0.93, 0.83, 0.35, 0.54, 0.16, 0.91, 0.62, 0.62)
y <- c(0.67, 0.84, 0.6, 0.18, 0.85, 0.47, 1.1, 0.65, 0.36)
q1<-lm(y~x)
summary(q1)
beta1<-cor(y,x)* sd(y)/sd(x)
beta()
beta1
summary(beta1)
data=mtcars
head(data)
q3<-lm(mpg~wt)
q3<-lm(mpg~wt, data=data)
summary(q3)
predict(fit,data.frame(x=mean(x)), interval="confidence")
predict(q3,data.frame(x=mean(x)), interval="confidence")
x<-mtcars$wt
y<-mtcars$mpg
fit<-lm(y ~ x)
predict(fit,data.frame(x=mean(x)), interval="confidence")
?mtcars
predict(fit,data.frame(x=3), interval="prediction")
predict(fit,data.frame(x=2), interval="prediction")
predict(fit,data.frame(x=5), interval="prediction")
predict(fit,data.frame(x=.5), interval="prediction")
predict(fit,data.frame(x=x/2), interval="prediction")
fit2<-lm(y~I(x/2))
tbl2<-summary(fit2)$coefficients
summary(tbl2)
tbl2
summary(fit2)
predict(fit2,data.frame(x=mean(x)), interval="confidence")
swil()
swirl()
library(swirl)
swirl()
View(InsectSprays)
dim(InsectSprays)
head(InsectSprays)
head(InsectSprays,15)
s!
sA
summary(InsectSprays[,2])
sapply(InsectSprays)
sapply(class(InsectSprays))
sapply(InsectSprays,class)
lm(count~spray, InsectSprays)
fit<-lm(count~spray, Insectsprays)
fit<-lm(count~spray, InsectSprays)
summary(fit$coefficients)
summary(fit)$coef
est<-fit$coef[,1]
est<-Summary(fit)$coef[,1]
Summary(fit)$coef[,1]
summary(fit)$coef[,1]
est<-summary(fit)$coef[,1]
mean(sA)
mean(sB)
nfit<-lm(count~spray-1, InsectSprays)
summary(nfit)$coef
spray2<-relevel(InsectSprays$spray, "C")
fit2<-lm(count~spray, spray2)
fit2<-lm(count~spray2, InsectSprays)
summary(fit2)$coef
mean(sC)
fit$coef[2]-fit$coef[3]
(fit$coef[2]-fit$coef[3])/1.0611
(fit$coef[2]-fit$coef[3])/1.6011
library(mtcars)
mtcars
head(mtcars)
fit<-lm(mpg~cyl+wt)
fit<-lm(mpg~cyl+wt,data=mtcars)
summary(fit)
summary(fit)$coef
summary(fit)$coef[3,1]
mtcars$cyl1<-factor(mtcars$cyl)
fit<-lm(mpg~cyl+wt,data=mtcars)
summary(fit)$coef
summary(fit)$coef[3,1]
mtcars$cyl<- factor(mtcars$cyl)
fit<- lm(mpg~cyl+wt,mtcars)
summary(fit)$coef[3,1]
summary(fit)$coef
fitun<-lm(mpg~cyl, data=mtcars)
summary(fitun)$coef[3,1]
fitin<-lm(mpg~cyl*wt,data=mtcars)
summary(fitin)
summary(fit)
library(lmtest)
install.packages("lmtest")
lrtest(fit,fitin)
library(lmtest)
lrtest(fit,fitin)
lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
fit4<-lm(mpg ~ I(wt * 0.5) + factor(cyl), data = mtcars)
summary(fit4)
summary(fit4)$coef[2,1]
x <- c(0.586, 0.166, -0.042, -0.614, 11.72)
y <- c(0.549, -0.026, -0.127, -0.751, 1.344)
fit<- lm(y~x)
predict(fit)
hat(x,intercept = TRUE)
influence.measures(fit)$infmat[5,"dfb.x"]
dfbeta(x)
dfbeta(fit)
dfbeta(fit,influence)
setwd("C:/Users/vmc04/Dropbox/Wing project")
quicklind<-read.csv("Quick csize lin.csv", headers=TRUE)
quicklind<-read.csv("Quick csize lin.csv", header=TRUE)
head(quicklind)
fit<-lm(Csize~Latitude, data=quicklind)
fit<-lm(quicklind$Csize~quicklind$Latitude)
fit<-lm(quicklind$CSize~quicklind$Latitude)
summary(fit)
plot(fit)
setwd("C:/Users/virgc/Documnets/GitHub/Summary wing excel files")
setwd("C:/Users/vmc04/Documnets/GitHub/Summary wing excel files")
setwd("C:/Users/vmc04/Documents/GitHub/Summary wing excel files")
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/Summary wing excel files")
quickie<-read.csv("2017_08_20 Wing lab cs length 13 18.csv", header=TRUE)
quickie$Locality=factor(quickie$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
View(quickie)
xWL<-aggregate (quickie$Wing.length..mm., list (LOC= quickie$Locality, TEMP= quickie$Temp.Num ),mean, na.rm=TRUE)
write.table(xWL, "clipboard", sep='\t', row.names=FALSE)
xWL<-aggregate (quickie$Wing.length..mm., list (LOC= quickie$Locality, TEMP= quickie$Temp.Num, Sex= quickie$Sex ),mean, na.rm=TRUE)
write.table(xWL, "clipboard", sep='\t', row.names=FALSE)
xWLsd<-aggregate (quickie$Wing.length..mm., list (LOC= quickie$Locality, TEMP= quickie$Temp.Num, Sex= quickie$Sex ),sd, na.rm=TRUE)
write.table(xWLsd, "clipboard", sep='\t', row.names=FALSE)
quickiefield<-read.csv("2017_08_23 Field wing length.csv", header=TRUE)
quickiefield$Locality=factor(quickiefield$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
quickiefield<-read.csv("2017_08_23 Field wing length.csv", header=TRUE)
quickiefield$Locality=factor(quickiefield$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
xWL<-aggregate (quickiefield$Wing.length..mm., list (LOC= quickiefield$Locality ),mean, na.rm=TRUE)
write.table(xWL, "clipboard", sep='\t', row.names=FALSE)
View(quickiefield)
xWL<-aggregate (quickiefield$Length.mm, list (LOC= quickiefield$Locality ),mean, na.rm=TRUE)
write.table(xWL, "clipboard", sep='\t', row.names=FALSE)
xWLsd<-aggregate (quickie$Length.mm, list (LOC= quickiefield$Locality ),sd, na.rm=TRUE)
write.table(xWLsd, "clipboard", sep='\t', row.names=FALSE)
xWLsd<-aggregate (quickiefield$Length.mm, list (LOC= quickiefield$Locality ),sd, na.rm=TRUE)
write.table(xWLsd, "clipboard", sep='\t', row.names=FALSE)
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/Repeat score testing")
mainfile<-read.csv("2017_08_23 Field 18L landmarks scaled.csv", header=TRUE)
mainfile$Locality=factor(mainfile$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
mainfile<-read.csv("2017_08_23 Field 18 landmarks scaled.csv", header=TRUE)
mainfile$Locality=factor(mainfile$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
winglist<-read.csv("List for field repeatability.csv", header=TRUE)
head(mainfile)
View(winglist)
mainfile<-read.csv("2017_08_23 Field 18 landmarks scaled.csv", header=TRUE)
mainfile$Locality=factor(mainfile$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
comp<-merge(mainfile, winglist, by="Code")
View(comp)
write.csv(comp, "Field 18L original landmarks for repeatability.csv")
setwd("C:/Users/vmc04/Documents/GitHub/wingproj/Summary wing excel files")
quickiefield<-read.csv("2017_08_23 Field wing length 13 18 cs scaled.csv", header=TRUE)
quickiefield$Locality=factor(quickiefield$Locality, c("ARS","APR","RPV","RMO","TLC","TPN","SJU"))
View(quickiefield)
x13cs<-aggregate (quickiefield$X13.CS.scaled, list (LOC= quickiefield$Locality ),mean, na.rm=TRUE)
write.table(xWL, "clipboard", sep='\t', row.names=FALSE)
x13cssd<-aggregate (quickiefield$X13.CS.scaled, list (LOC= quickiefield$Locality ),sd, na.rm=TRUE)
write.table(xWLsd, "clipboard", sep='\t', row.names=FALSE)
x13cs<-aggregate (quickiefield$X13.CS.scaled, list (LOC= quickiefield$Locality ),mean, na.rm=TRUE)
write.table(x13cs, "clipboard", sep='\t', row.names=FALSE)
x13cssd<-aggregate (quickiefield$X13.CS.scaled, list (LOC= quickiefield$Locality ),sd, na.rm=TRUE)
write.table(X13cssd, "clipboard", sep='\t', row.names=FALSE)
View(x13cssd)
x13cssd<-aggregate (quickiefield$X13.CS.scaled, list (LOC= quickiefield$Locality ),sd, na.rm=TRUE)
write.table(x13cssd, "clipboard", sep='\t', row.names=FALSE)
x18cs<-aggregate (quickiefield$X18.CS.scaled, list (LOC= quickiefield$Locality ),mean, na.rm=TRUE)
write.table(x18cs, "clipboard", sep='\t', row.names=FALSE)
x18cssd<-aggregate (quickiefield$X18.CS.scaled, list (LOC= quickiefield$Locality ),sd, na.rm=TRUE)
write.table(x18cssd, "clipboard", sep='\t', row.names=FALSE)
with(quickiefield, boxplot(X13.CS.scaled~Locality, col=(c("purple","orange", "green")),main="Field P wings-13 landmarks CS measure", xlab="Grouping", ylab="Centroid Size (mm)"))
with(quickiefield, boxplot(X13.CS.scaled~Locality, col=(c("forestgreen","forestgreen","forestgreen","forestgreen","darkorange2","darkorange2", "darkorchid3")),medcol=(c("gold1")), main="Field P wings-13 landmarks CS measure", xlab="Grouping", ylab="Centroid Size (mm)"))
with(quickiefield, boxplot(X13.CS.scaled~Locality, col=(c("forestgreen","forestgreen","forestgreen","forestgreen","dimgray","dimgray", "darkorchid3")),medcol=(c("gold1")), main="Field P wings-13 landmarks CS measure", xlab="Grouping", ylab="Centroid Size (mm)"))
with(quickiefield, boxplot(X13.CS.scaled~Locality, col=(c("black","black","black","black","dimgray","dimgray", "white")),medcol=(c("white", "white","white","white","white","white","black" )), main="Field P wings-13 landmarks CS measure", xlab="Grouping", ylab="Centroid Size (mm)"))
with(quickiefield, boxplot(X18.CS.scaled~Locality, col=(c("black","black","black","black","dimgray","dimgray", "white")),medcol=(c("white", "white","white","white","white","white","black" )), main="Field P wings-13 landmarks CS measure", xlab="Grouping", ylab="Centroid Size (mm)"))
wing.modfield=aov(Length.mm~Locality, data=quickiefield)
summary(wing.modfield)
wing.modfield1=aov(X13.CS.scaled~Locality, data=quickiefield)
summary(wing.modfield1)
wing.modfield2=aov(X18.CS.scaled~Locality, data=quickiefield)
summary(wing.modfield2)
with(quickiefield, boxplot(Length.mm~Locality, col=(c("black","black","black","black","dimgray","dimgray", "white")),medcol=(c("white", "white","white","white","white","white","black" )), main="Field P wings-13 landmarks CS measure", xlab="Grouping", ylab="Centroid Size (mm)"))
with(quickiefield, boxplot(Length.mm~Locality, col=(c("black","black","black","black","dimgray","dimgray", "white")),medcol=(c("white", "white","white","white","white","white","black" )), main="Field P wings-Wing length", xlab="Locality", ylab="Centroid Size (mm)"))
with(quickiefield, boxplot(X13.CS.scaled~Locality, col=(c("black","black","black","black","dimgray","dimgray", "white")),medcol=(c("white", "white","white","white","white","white","black" )), main="Field P wings-13 landmarks CS measure", xlab="Locality", ylab="Centroid Size (mm)"))
with(quickiefield, boxplot(X18.CS.scaled~Locality, col=(c("black","black","black","black","dimgray","dimgray", "white")),medcol=(c("white", "white","white","white","white","white","black" )), main="Field P wings-18 landmarks CS measure", xlab="Locality", ylab="Centroid Size (mm)"))
library(agricolae)
print(HSD.test(wing.modfield, 'Locality'))
print(HSD.test(wing.modfield1, 'Locality'))
print(HSD.test(wing.modfield2, 'Locality'))
wing.mod5=aov(Wing.length..mm.~Locality+Sex+Temp.Num, data=quickie)
summary(wing.mod5)
print(HSD.test(wing.mod3, 'Locality'))
print(HSD.test(wing.mod5, 'Locality'))
head(quickie)
fit13<-manova (CS.scaled.13~Locality*Temp.Num*Sex, data=quickie)
